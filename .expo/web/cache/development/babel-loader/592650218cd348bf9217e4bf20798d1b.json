{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\zmais\\\\OneDrive\\\\Desktop\\\\react-apps\\\\signal-chat\\\\screens\\\\Chat\\\\AddMore.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useLayoutEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { Button, Input } from 'react-native-elements';\nimport Icon from \"@expo/vector-icons/FontAwesome\";\nimport { auth, db } from \"../../services/firebase\";\nimport { CardItem, Thumbnail, Body, Left, Right, Container } from 'native-base';\nexport default function AddMore(props) {\n  var navigation = props.navigation;\n  var _props$route$params = props.route.params,\n      addedUsers = _props$route$params.addedUsers,\n      chatName = _props$route$params.chatName,\n      chatId = _props$route$params.chatId;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      searchUsers = _useState2[0],\n      setSearchUsers = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      users = _useState4[0],\n      setUsers = _useState4[1];\n\n  var _useState5 = useState(addedUsers),\n      _useState6 = _slicedToArray(_useState5, 2),\n      chatMembers = _useState6[0],\n      setChatMembers = _useState6[1];\n\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: \"Add More friends to \" + chatName\n    });\n  }, [navigation]);\n\n  function updateChatMembers() {\n    db.collection(\"chats\").doc(chatId).update({\n      chatMembers: chatMembers\n    });\n    navigation.goBack();\n  }\n\n  function addChatMember(personInfo) {\n    if (chatMembers.includes(personInfo.uid) == false) {\n      setChatMembers(function (chatMembers) {\n        return [].concat(_toConsumableArray(chatMembers), [personInfo.uid]);\n      });\n    } else {\n      for (var i = 0; i < chatMembers.length; i++) {\n        if (chatMembers[i] === personInfo.uid) {\n          setChatMembers(function (chatMembers) {\n            return _toConsumableArray(chatMembers).splice(i);\n          });\n        }\n      }\n    }\n  }\n\n  function fetchUsers(search) {\n    db.collection('users').where('displayName', '>=', search).get().then(function (snapshot) {\n      var users = snapshot.docs.map(function (doc) {\n        var data = doc.data();\n        var id = doc.id;\n        return _objectSpread({\n          id: id\n        }, data);\n      });\n      setUsers(users);\n    });\n  }\n\n  function renderPerson(item) {\n    function itemStyle() {\n      if (chatMembers.includes(item.uid)) {\n        return {\n          backgroundColor: 'green'\n        };\n      } else {\n        return {\n          backgroundColor: 'white'\n        };\n      }\n    }\n\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return addChatMember(item);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }, React.createElement(CardItem, {\n      style: itemStyle(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, React.createElement(Left, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }\n    }, React.createElement(Thumbnail, {\n      source: {\n        uri: item.photoURL\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }), React.createElement(Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, React.createElement(Text, {\n      h5: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }, item.displayName, \" \"), React.createElement(Text, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }\n    }, item.email))))));\n  }\n\n  fetchUsers(searchUsers);\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, React.createElement(Button, {\n    title: \"Add More Users\",\n    onPress: updateChatMembers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }), React.createElement(TextInput, {\n    style: styles.textInput,\n    placeholder: \"Seach for User...\",\n    onChangeText: function onChangeText(searchUsers) {\n      return setSearchUsers(searchUsers);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }), React.createElement(FlatList, {\n    style: styles.userBox,\n    numColumns: 1,\n    horizontal: false,\n    data: users,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return renderPerson(item);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  container: {\n    backgroundColor: \"white\",\n    padding: 30,\n    height: \"100%\"\n  },\n  textInput: {\n    bottom: -20,\n    flex: 1,\n    marginRight: 15,\n    backgroundColor: \"#ECECEC\",\n    padding: 25,\n    color: \"grey\",\n    borderRadius: 30\n  },\n  userBox: {\n    bottom: -80\n  }\n});","map":{"version":3,"sources":["C:/Users/zmais/OneDrive/Desktop/react-apps/signal-chat/screens/Chat/AddMore.js"],"names":["React","useLayoutEffect","useState","Button","Input","Icon","auth","db","CardItem","Thumbnail","Body","Left","Right","Container","AddMore","props","navigation","route","params","addedUsers","chatName","chatId","searchUsers","setSearchUsers","users","setUsers","chatMembers","setChatMembers","setOptions","title","updateChatMembers","collection","doc","update","goBack","addChatMember","personInfo","includes","uid","i","length","splice","fetchUsers","search","where","get","then","snapshot","docs","map","data","id","renderPerson","item","itemStyle","backgroundColor","uri","photoURL","displayName","email","styles","container","textInput","userBox","StyleSheet","create","padding","height","bottom","flex","marginRight","color","borderRadius"],"mappings":"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","sourcesContent":["import React, {useLayoutEffect, useState} from 'react'\r\nimport {View, Text, StyleSheet, TouchableOpacity, TextInput, FlatList } from 'react-native'\r\nimport { Button, Input } from 'react-native-elements'\r\nimport  Icon  from 'react-native-vector-icons/FontAwesome' ;\r\nimport { auth, db } from '../../services/firebase';\r\nimport { CardItem, Thumbnail, Body, Left, Right, Container} from 'native-base'\r\n\r\n\r\nexport default function AddMore(props) {\r\n\r\n    const navigation = props.navigation\r\n\r\n    const {addedUsers, chatName, chatId} = props.route.params\r\n\r\n    const [searchUsers, setSearchUsers] = useState('')\r\n    const [users, setUsers] = useState([]);\r\n    const [chatMembers, setChatMembers] =  useState(addedUsers);\r\n\r\n\r\n\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({\r\n            title: \"Add More friends to \"  + chatName,\r\n            \r\n        })\r\n        \r\n    }, [navigation])\r\n\r\n    function updateChatMembers(){\r\n        db.collection(\"chats\")\r\n            .doc(chatId)\r\n            .update({\r\n                chatMembers: chatMembers\r\n            })\r\n\r\n        navigation.goBack()\r\n    }\r\n\r\n\r\n    function addChatMember(personInfo){\r\n        if (chatMembers.includes(personInfo.uid) == false){\r\n            setChatMembers(chatMembers => [...chatMembers, personInfo.uid])\r\n        }\r\n        else {\r\n            for( var i = 0; i < chatMembers.length; i++){ \r\n                                   \r\n                if ( chatMembers[i] === personInfo.uid) { \r\n                    setChatMembers(chatMembers => [...chatMembers].splice(i))\r\n                }\r\n            }\r\n            \r\n\r\n        }\r\n    }\r\n\r\n    function fetchUsers(search){\r\n        //console.warn(\"Function was called\")\r\n        db.collection('users')\r\n            .where('displayName', '>=', search)\r\n            .get()\r\n            .then((snapshot) => {\r\n                let users = snapshot.docs.map(doc => {\r\n                    const data = doc.data();\r\n                    const id = doc.id;\r\n                    return { id, ...data }\r\n                });\r\n                setUsers(users);\r\n        })\r\n\r\n \r\n       \r\n    }\r\n\r\n    function renderPerson(item){\r\n\r\n        function itemStyle(){\r\n            if (chatMembers.includes(item.uid)){\r\n                return {backgroundColor:'green'} \r\n                \r\n            }\r\n            else {\r\n                return {backgroundColor:'white'}\r\n            }\r\n        }\r\n\r\n\r\n\r\n                        \r\n        return (\r\n            <View>\r\n\r\n            <TouchableOpacity onPress={() => addChatMember(item)}> \r\n                <CardItem style={itemStyle()}>\r\n            <Left>\r\n                <Thumbnail source={{uri: item.photoURL}} />\r\n\r\n                <Body>\r\n                    <Text h5>{item.displayName} </Text>\r\n                    <Text>{item.email}</Text>\r\n                </Body>\r\n            </Left>\r\n            </CardItem>\r\n            </TouchableOpacity> \r\n        \r\n            </View>\r\n        )\r\n\r\n\r\n    }\r\n\r\n    fetchUsers(searchUsers)\r\n\r\n    \r\n\r\n    \r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            \r\n\r\n            <Button  title=\"Add More Users\" onPress={updateChatMembers}></Button>\r\n\r\n            <TextInput\r\n                    style={styles.textInput}\r\n                    placeholder=\"Seach for User...\"\r\n                    onChangeText={(searchUsers) => setSearchUsers(searchUsers)} />\r\n\r\n\r\n            <FlatList\r\n                style={styles.userBox}\r\n                numColumns={1}\r\n                horizontal={false}\r\n                data={users}\r\n                renderItem={({ item }) => (\r\n                   renderPerson(item)\r\n\r\n                )}/>\r\n\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        backgroundColor: \"white\",\r\n        padding: 30,\r\n        height: \"100%\",\r\n\r\n    },\r\n    textInput: {\r\n        bottom: -20,\r\n        flex: 1,\r\n        marginRight: 15,\r\n        backgroundColor: \"#ECECEC\",\r\n        padding:25,\r\n        color: \"grey\",\r\n        borderRadius: 30,\r\n\r\n    },\r\n    userBox: {\r\n        bottom: -80,\r\n    }\r\n\r\n})\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}