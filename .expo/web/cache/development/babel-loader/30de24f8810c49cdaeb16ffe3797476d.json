{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\zmais\\\\OneDrive\\\\Desktop\\\\react-apps\\\\signal-chat\\\\screens\\\\Post\\\\Feed.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { Container, Content, Icon, Thumbnail, Header, Left, Right, Body } from 'native-base';\nimport PostCard from \"../../components/PostCard\";\nimport { auth, db } from \"../../services/firebase\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport Stories from \"../../components/Stories\";\nexport default function Feed(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      posts = _useState2[0],\n      setPosts = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      userFollowing = _useState4[0],\n      setUserFollowing = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      userInfo = _useState6[0],\n      setUserInfo = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      scrollEnd = _useState8[0],\n      setScrollEnd = _useState8[1];\n\n  var _useState9 = useState(5),\n      _useState10 = _slicedToArray(_useState9, 2),\n      page = _useState10[0],\n      setPage = _useState10[1];\n\n  var postsFor = auth.currentUser.uid;\n  useEffect(function () {\n    function main() {\n      var userLoop, executeLoop, mainloop;\n      return _regeneratorRuntime.async(function main$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              mainloop = function _mainloop(item, index, arr) {\n                return _regeneratorRuntime.async(function mainloop$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        _context3.next = 2;\n                        return _regeneratorRuntime.awrap(db.collection('posts').doc(item.data.userId).collection('userPosts').orderBy('creation', 'desc').onSnapshot(function (snapshot) {\n                          var thisPosts = snapshot.docs.map(function (doc) {\n                            return {\n                              id: doc.id,\n                              user: item.data.userId,\n                              data: doc.data()\n                            };\n                          });\n                          setPosts(function (posts) {\n                            return _toConsumableArray(posts).concat(thisPosts);\n                          });\n                        }));\n\n                      case 2:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              };\n\n              executeLoop = function _executeLoop(array) {\n                return _regeneratorRuntime.async(function executeLoop$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        array.forEach(userLoop);\n                        array.forEach(mainloop);\n\n                      case 2:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              };\n\n              userLoop = function _userLoop(item, index, arr) {\n                return _regeneratorRuntime.async(function userLoop$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return _regeneratorRuntime.awrap(db.collection(\"users\").doc(item.data.userId).get().then(function (doc) {\n                          setUserFollowing([].concat(_toConsumableArray(userFollowing), [item]));\n                          setUserInfo(function (userInfo) {\n                            return [].concat(_toConsumableArray(userInfo), [{\n                              uid: doc.data().uid,\n                              index: index,\n                              data: doc.data()\n                            }]);\n                          });\n                        }));\n\n                      case 2:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              };\n\n              _context4.next = 5;\n              return _regeneratorRuntime.awrap(db.collection('following').doc(postsFor).collection('userFollowing').orderBy('timestamp', 'desc').onSnapshot(function (snapshot) {\n                return executeLoop(snapshot.docs.map(function (doc) {\n                  return {\n                    id: doc.id,\n                    data: doc.data()\n                  };\n                }));\n              }));\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    main();\n  }, []);\n  console.warn;\n\n  function getphotoUrl(uid) {\n    if (userInfo.length > 0) {\n      var picInfo = userInfo.filter(function (value) {\n        return value.uid == uid;\n      })[0].data.photoURL;\n      return picInfo;\n    } else {\n      return 'null';\n    }\n  }\n\n  function getEmail(uid) {\n    if (userInfo.length > 0) {\n      var emailInfo = userInfo.filter(function (value) {\n        return value.uid == uid;\n      })[0].data.email;\n      return emailInfo;\n    } else {\n      return 'null';\n    }\n  }\n\n  function getDisplayName(uid) {\n    if (userInfo.length > 0) {\n      var nameInfo = userInfo.filter(function (value) {\n        return value.uid == uid;\n      })[0].data.displayName;\n      return nameInfo;\n    } else {\n      return 'null';\n    }\n  }\n\n  function renderPosts() {\n    var _this = this;\n\n    function endReached() {\n      if (page < posts.length) {\n        setPage(page + 5);\n      }\n    }\n\n    if (posts.length == 0) {\n      return React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }\n      }, \"Nothing on your feed yet\"));\n    } else if (posts.length > 5) {\n      var qPosts = posts.slice(0, page);\n    } else {\n      var qPosts = posts;\n    }\n\n    return React.createElement(FlatList, {\n      numColumns: 1,\n      horizontal: false,\n      data: qPosts,\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item;\n        return React.createElement(TouchableOpacity, {\n          onPress: function onPress() {\n            return navigation.navigate(\"Post-Detail\", {\n              id: item.id,\n              posterName: getDisplayName(item.user),\n              PosterId: item.user,\n              posterProfilePic: getphotoUrl(item.user),\n              image: item.data.downloadURL,\n              postDate: \"idk\",\n              caption: item.data.caption,\n              likes: item.data.likesCount,\n              navigation: navigation,\n              email: getEmail(item.user)\n            });\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 21\n          }\n        }, React.createElement(PostCard, {\n          key: item.id,\n          id: item.id,\n          posterName: getDisplayName(item.user),\n          posterProfilePic: getphotoUrl(item.user),\n          email: getEmail(item.user),\n          PosterId: item.user,\n          image: item.data.downloadURL,\n          postDate: item.data.creation,\n          caption: item.data.caption,\n          likes: item.data.likesCount,\n          navigation: navigation,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 21\n          }\n        }));\n      },\n      onEndReachedThreshold: 0.5,\n      onEndReached: function onEndReached() {\n        return setPage(page + 5);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 13\n      }\n    });\n  }\n\n  return React.createElement(Container, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 13\n    }\n  }, React.createElement(Stories, {\n    userFollowing: userFollowing,\n    navigation: navigation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }), renderPosts());\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"white\"\n  }\n});","map":{"version":3,"sources":["C:/Users/zmais/OneDrive/Desktop/react-apps/signal-chat/screens/Post/Feed.js"],"names":["React","useState","useEffect","Container","Content","Icon","Thumbnail","Header","Left","Right","Body","PostCard","auth","db","ScrollView","Stories","Feed","navigation","posts","setPosts","userFollowing","setUserFollowing","userInfo","setUserInfo","scrollEnd","setScrollEnd","page","setPage","postsFor","currentUser","uid","main","userLoop","executeLoop","mainloop","item","index","arr","collection","doc","data","userId","orderBy","onSnapshot","snapshot","thisPosts","docs","map","id","user","concat","array","forEach","get","then","console","warn","getphotoUrl","length","picInfo","filter","value","photoURL","getEmail","emailInfo","email","getDisplayName","nameInfo","displayName","renderPosts","endReached","qPosts","slice","navigate","posterName","PosterId","posterProfilePic","image","downloadURL","postDate","caption","likes","likesCount","creation","styles","container","StyleSheet","create","flex","backgroundColor"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport { StyleSheet, Text, View, TouchableOpacity, FlatList } from 'react-native'\r\nimport { Container, Content, Icon, Thumbnail, Header, Left, Right, Body } from 'native-base'\r\nimport PostCard from '../../components/PostCard'\r\nimport { auth, db } from '../../services/firebase'\r\nimport { ScrollView } from 'react-native-gesture-handler'\r\nimport Stories from '../../components/Stories'\r\n\r\n\r\n\r\nexport default function Feed({ navigation }) {\r\n\r\n    const [posts, setPosts] = useState([]);\r\n    const [userFollowing, setUserFollowing] = useState([])\r\n    const [userInfo, setUserInfo] = useState([])\r\n    const [scrollEnd, setScrollEnd] = useState(false);\r\n    const [page, setPage] = useState(5)\r\n\r\n    \r\n\r\n    const postsFor = auth.currentUser.uid;\r\n\r\n    useEffect(() => {    \r\n\r\n\r\n        async function main(){\r\n\r\n        \r\n            await db.collection('following')\r\n                    .doc(postsFor).collection('userFollowing')\r\n                    .orderBy('timestamp', 'desc')\r\n                    .onSnapshot((snapshot) => executeLoop(snapshot.docs.map(doc => ({\r\n                    id: doc.id,\r\n                    data: doc.data()\r\n\r\n            }))))\r\n            \r\n\r\n            async function userLoop(item, index, arr){\r\n                    await db.collection(\"users\").doc(item.data.userId).get().then((doc) => {\r\n                        setUserFollowing([...userFollowing, item])\r\n                        setUserInfo(userInfo => [...userInfo, {uid: doc.data().uid, index: index, data: doc.data()}]\r\n                        )\r\n                        \r\n                    })\r\n\r\n            }\r\n\r\n            async function executeLoop(array){\r\n                array.forEach(userLoop)\r\n                array.forEach(mainloop)\r\n                \r\n            }\r\n\r\n            async function mainloop(item, index, arr){\r\n                await db.collection('posts')\r\n                .doc(item.data.userId).collection('userPosts')\r\n                .orderBy('creation', 'desc')\r\n                .onSnapshot((snapshot) =>  {\r\n                    var thisPosts = snapshot.docs.map(doc => ({\r\n                id: doc.id,\r\n                user: item.data.userId,\r\n                data: doc.data()\r\n                })\r\n                )\r\n                setPosts(posts => [...posts].concat(thisPosts))\r\n                })\r\n\r\n            }\r\n        \r\n            \r\n        }\r\n\r\n        main()\r\n            \r\n    }, [])\r\n\r\n    console.warn\r\n\r\n\r\n    function getphotoUrl(uid){\r\n\r\n        \r\n        if (userInfo.length > 0){\r\n            var picInfo = userInfo.filter(function(value){\r\n                return value.uid == uid\r\n            })[0].data.photoURL\r\n         \r\n            return picInfo\r\n\r\n        }\r\n        else {\r\n            return 'null'\r\n        }\r\n    }\r\n\r\n    function getEmail(uid){\r\n\r\n        \r\n        if (userInfo.length > 0){\r\n            var emailInfo = userInfo.filter(function(value){\r\n                return value.uid == uid\r\n            })[0].data.email\r\n         \r\n            return emailInfo\r\n\r\n        }\r\n        else {\r\n            return 'null'\r\n        }\r\n    }\r\n    \r\n\r\n    function getDisplayName(uid){\r\n\r\n        if (userInfo.length > 0){\r\n            var nameInfo = userInfo.filter(function(value){\r\n                return value.uid == uid\r\n            })[0].data.displayName\r\n\r\n            //console.log(nameInfo)\r\n\r\n            return nameInfo\r\n        }\r\n        else {\r\n            return 'null'\r\n        }\r\n\r\n\r\n    }\r\n\r\n    function renderPosts(){\r\n\r\n        function endReached(){\r\n            if (page < posts.length){\r\n                setPage(page + 5)\r\n                \r\n            }\r\n        }\r\n      \r\n\r\n        if (posts.length == 0){\r\n            return (\r\n                <View>\r\n                    <Text >Nothing on your feed yet</Text>\r\n                </View>\r\n            )\r\n        }\r\n        \r\n        else if (posts.length > 5) {\r\n\r\n            var qPosts = posts.slice(0, page)\r\n        }\r\n        else {\r\n            var qPosts = posts;\r\n        }\r\n\r\n\r\n        \r\n\r\n        return (\r\n            <FlatList\r\n                numColumns={1}\r\n                horizontal={false}\r\n                data={qPosts}\r\n                renderItem={({ item }) => (\r\n                    <TouchableOpacity onPress={() => navigation.navigate(\"Post-Detail\", {\r\n                        id: item.id,\r\n                        posterName: getDisplayName(item.user),\r\n                        PosterId: item.user,\r\n                        posterProfilePic: getphotoUrl(item.user),\r\n                        image: item.data.downloadURL,\r\n                        postDate: \"idk\",\r\n                        caption: item.data.caption,\r\n                        likes: item.data.likesCount,\r\n                        navigation: navigation,\r\n                        email: getEmail(item.user)\r\n                        \r\n                    })}>\r\n                    <PostCard\r\n                    //key={id}\r\n                    key={item.id}\r\n                    id={item.id}\r\n                    posterName={getDisplayName(item.user)}\r\n                    posterProfilePic={getphotoUrl(item.user)}\r\n                    email={getEmail(item.user)}\r\n                    PosterId={item.user}\r\n                    \r\n                    image={item.data.downloadURL}\r\n                    postDate={item.data.creation}\r\n                    caption={item.data.caption}\r\n                    likes={item.data.likesCount}\r\n                    navigation={navigation}\r\n                    \r\n                    />\r\n                    </TouchableOpacity>\r\n\r\n                )}\r\n                //onMomentumScrollBegin={() => setScrollEnd(false)}\r\n                //onMomentumScrollEnd={() => console.warn(\"end reached\")}   \r\n                onEndReachedThreshold={0.5}           \r\n                //onScrollToTop={() => setPage(page - 5)}\r\n                onEndReached={() => setPage(page+5)}\r\n            />\r\n        )\r\n    \r\n        \r\n        \r\n    }\r\n\r\n    return (\r\n        \r\n            <Container style={styles.container}>\r\n                    <Stories\r\n                    userFollowing={userFollowing}\r\n                    navigation={navigation}\r\n                    />\r\n    \r\n                    {renderPosts()}\r\n                \r\n                \r\n                \r\n            </Container>\r\n\r\n        \r\n\r\n        \r\n    )\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: \"white\"\r\n\r\n    }\r\n})\r\n"]},"metadata":{},"sourceType":"module"}